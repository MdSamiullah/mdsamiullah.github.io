{%- comment -%}
cards-from-data.html
Usage:
  {% include cards-from-data.html datafile="teaching" %}
  {% include cards-from-data.html datafile="mentoring" %}

Expected YAML structure:
sections -> subsections -> items
{%- endcomment -%}

{%- assign dataset = site.data[include.datafile] -%}

{%- if dataset == nil -%}
  <p class="muted">
    No data found for <code>{{ include.datafile }}</code>.
    Check <code>_data/{{ include.datafile }}.yml</code>.
  </p>
{%- else -%}

  {%- for section in dataset.sections -%}
    <section class="data-section">

      {%- if section.title and section.title != "" -%}
        <h2 class="section-title">{{ section.title }}</h2>
      {%- endif -%}

      {%- for sub in section.subsections -%}

        {%- if sub.title and sub.title != "" -%}
          <h3 class="subsection-title">{{ sub.title }}</h3>
        {%- endif -%}

        {%- if sub.items and sub.items.size > 0 -%}
          <div class="cards-grid">

            {%- for item in sub.items -%}

              {%- if include.datafile == "mentoring" -%}
                <!-- ===================== -->
                <!-- Mentoring card format -->
                <!-- Project -->
                <!-- Role: Name (Year) -->
                <!-- ===================== -->
                <article class="info-card info-card--simple">

                  <h4 class="info-card__title">
                    {%- if item.project and item.project != "" -%}
                      {{ item.project }}
                    {%- elsif item.title and item.title != "" -%}
                      {{ item.title }}
                    {%- else -%}
                      Untitled Project
                    {%- endif -%}
                  </h4>

                  <div class="mentor-line">
                    {%- if item.role and item.role != "" -%}
                      <span class="mentor-role">{{ item.role }}</span>
                    {%- endif -%}
                    
                    {%- if item.name and item.name != "" -%}
                      <span class="mentor-name">{{ item.name }}</span>
                    {%- endif -%}
                    {%- if item.year and item.year != "" -%}
                      <span class="mentor-year">({{ item.year }})</span>
                    {%- endif -%}

                    {%- if item.url and item.url != "" -%}
                      <a class="meta-link" href="{{ item.url }}" target="_blank" rel="noreferrer">Link</a>
                    {%- endif -%}
                  </div>

                  {%- if item.description and item.description != "" -%}
                    <p class="info-card__desc">{{ item.description }}</p>
                  {%- endif -%}

                </article>

              {%- elsif include.datafile == "teaching" -%}
                <!-- =================== -->
                <!-- Teaching card format -->
                <!-- CODE (Year) + Role -->
                <!-- Title -->
                <!-- Description + optional URL link -->
                <!-- =================== -->
                <article class="info-card info-card--teach">

                  <div class="teach-top">
                    <div class="teach-codeyear">
                      {%- if item.code and item.code != "" -%}
                        <span class="teach-code">{{ item.code }}</span>
                      {%- endif -%}
                      {%- if item.year and item.year != "" -%}
                        <span class="teach-year">({{ item.year }})</span>
                      {%- endif -%}
                      {%- if item.role and item.role != "" -%}
                        <span class="teach-role">{{ item.role }}</span>
                      {%- endif -%}
                    </div>

                    {%- if item.url and item.url != "" -%}
                      <a class="meta-link" href="{{ item.url }}" target="_blank" rel="noreferrer">Link</a>
                    {%- endif -%}
                  </div>

                  <h4 class="info-card__title">
                    {%- if item.title and item.title != "" -%}
                      {{ item.title }}
                    {%- else -%}
                      Untitled Unit
                    {%- endif -%}
                  </h4>

                  {%- if item.description and item.description != "" -%}
                    <p class="info-card__desc">
                      {{ item.description }}
                      {%- if item.url and item.url != "" -%}
                        &nbsp;<a href="{{ item.url }}" target="_blank" rel="noreferrer">More</a>
                      {%- endif -%}
                    </p>
                  {%- else -%}
                    {%- if item.url and item.url != "" -%}
                      <p class="info-card__desc">
                        <a href="{{ item.url }}" target="_blank" rel="noreferrer">More details</a>
                      </p>
                    {%- endif -%}
                  {%- endif -%}

                </article>

              {%- elsif include.datafile == "portfolio" -%}
                <!-- =================== -->
                <!-- Portfolio card format (custom) -->
                <!-- Title -->
                <!-- Status + Year pills (right) -->
                <!-- Collaboration pill (with icon), FundingBody + Amount text (with icons) -->
                <!-- Year + URL -->
                <!-- Description -->
                <!-- Roles capsules (with icon) -->
                <!-- Keywords capsules -->
                <!-- =================== -->
                <article class="info-card info-card--portfolio">

                  <!-- Line 1: Title -->
                  <h4 class="info-card__title">
                    {%- if item.title and item.title != "" -%}
                      <b>{{ item.title }}</b>
                    {%- elsif item.name and item.name != "" -%}
                      <b>{{ item.name }}</b>
                    {%- else -%}
                      <b>Untitled Project</b>
                    {%- endif -%}
                  </h4>

                  <!-- Line 2: top meta row (Status + Year pills right-aligned) -->
                  <div class="portfolio-top">
                    <div class="portfolio-top__left">
                      {%- if item.issuer and item.issuer != "" -%}
                        <span class="portfolio-issuer">{{ item.issuer }}</span>
                      {%- endif -%}
                    </div>

                    <div class="portfolio-top__right">
                      {%- if item.status and item.status != "" -%}
                        <span class="meta-pill meta-pill--status">
                          {{ item.status }}
                        </span>
                      {%- endif -%}

                      {%- if item.year and item.year != "" -%}
                        <span class="meta-pill meta-pill--year">
                          <!-- Graduation hat icon -->
                          <span class="pill-ico" aria-hidden="true">
                            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                              <path d="M22 10L12 5 2 10l10 5 10-5z"></path>
                              <path d="M6 12v5c0 1.5 3 3 6 3s6-1.5 6-3v-5"></path>
                            </svg>
                          </span>
                          {{ item.year }}
                        </span>
                      {%- endif -%}
                    </div>
                  </div>

                  <!-- Line 3: Collaboration (pill + handshake icon), Funding body & amount (plain text + icons) -->
                  <div class="meta-row">
                    {%- if item.collaboration and item.collaboration != "" -%}
                      <span class="meta-pill meta-pill--collab">
                        <span class="pill-ico" aria-hidden="true">
                          <!-- Handshake icon -->
                          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M7 12l2 2c1.2 1.2 3.1 1.2 4.3 0l5.2-5.2"></path>
                            <path d="M16 7l2 2"></path>
                            <path d="M2 12l5-5 5 5"></path>
                            <path d="M22 12l-4-4"></path>
                          </svg>
                        </span>
                        {{ item.collaboration }}
                      </span>
                    {%- endif -%}

                    {%- if item.fundingBody and item.fundingBody != "" -%}
                      <span class="meta-text">
                        <span class="meta-ico" aria-hidden="true">
                          <!-- Bank icon -->
                          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 10h18"></path>
                            <path d="M4 10V7l8-4 8 4v3"></path>
                            <path d="M6 10v9"></path>
                            <path d="M10 10v9"></path>
                            <path d="M14 10v9"></path>
                            <path d="M18 10v9"></path>
                            <path d="M4 19h16"></path>
                          </svg>
                        </span>
                        {{ item.fundingBody }}
                      </span>
                    {%- endif -%}

                    {%- if item.amount and item.amount != "" -%}
                      <span class="meta-text">
                        <span class="meta-ico" aria-hidden="true">
                          <!-- Dollar icon -->
                          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 2v20"></path>
                            <path d="M17 6.5c0-2-2.2-3.5-5-3.5S7 4.5 7 6.5 9.2 10 12 10s5 1.5 5 3.5S14.8 17 12 17s-5-1.5-5-3.5"></path>
                          </svg>
                        </span>
                        ({{ item.amount }})
                      </span>
                    {%- endif -%}
                  </div>

                  <!-- Line 4: URL row -->
                  <div class="meta-row">
                    {%- if item.url and item.url != "" -%}
                      <a class="meta-link" href="{{ item.url }}" target="_blank" rel="noreferrer">Link</a>
                    {%- endif -%}
                    {%- if item.github and item.github != "" -%}
                      <a class="meta-link" href="{{ item.github }}" target="_blank" rel="noreferrer">GitHub</a>
                    {%- endif -%}
                    {%- if item.demo and item.demo != "" -%}
                      <a class="meta-link" href="{{ item.demo }}" target="_blank" rel="noreferrer">Demo</a>
                    {%- endif -%}
                  </div>

                  <!-- Description -->
                  {%- if item.description and item.description != "" -%}
                    <p class="info-card__desc">{{ item.description }}</p>
                  {%- endif -%}

                  <!-- Roles: support roles as list OR Role as string -->
                  {%- assign role_list = nil -%}
                  {%- if item.roles and item.roles.size > 0 -%}
                    {%- assign role_list = item.roles -%}
                  {%- elsif item.Role and item.Role != "" -%}
                    {%- assign role_list = item.Role | split: "," -%}
                  {%- elsif item.role and item.role != "" -%}
                    {%- assign role_list = item.role | split: "," -%}
                  {%- endif -%}

                  {%- if role_list -%}
                    <div class="meta-row">
                      {%- for r in role_list -%}
                        {%- assign rr = r | strip -%}
                        {%- if rr != "" -%}
                          <span class="meta-pill meta-pill--role">
                            <span class="pill-ico" aria-hidden="true">
                              <!-- Person/role icon -->
                              <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20 21a8 8 0 0 0-16 0"></path>
                                <circle cx="12" cy="8" r="4"></circle>
                              </svg>
                            </span>
                            {{ rr }}
                          </span>
                        {%- endif -%}
                      {%- endfor -%}
                    </div>
                  {%- endif -%}

                  <!-- Keywords: support keywords as list OR "a; b; c" string -->
                  {%- assign kw_list = nil -%}
                  {%- if item.keywords and item.keywords.size > 0 -%}
                    {%- assign kw_list = item.keywords -%}
                  {%- elsif item.Keywords and item.Keywords != "" -%}
                    {%- assign kw_list = item.Keywords | split: ";" -%}
                  {%- elsif item.keywords and item.keywords != "" -%}
                    {%- assign kw_list = item.keywords | split: ";" -%}
                  {%- endif -%}

                  {%- if kw_list -%}
                    <div class="meta-row">
                      {%- for k in kw_list -%}
                        {%- assign kk = k | strip -%}
                        {%- if kk != "" -%}
                          <span class="meta-pill meta-pill--kw">{{ kk }}</span>
                        {%- endif -%}
                      {%- endfor -%}
                    </div>
                  {%- endif -%}

                </article>

              {%- elsif include.datafile == "certificates" -%}
                <!-- ====================== -->
                <!-- Certificates card format -->
                <!-- Title + Year pill -->
                <!-- Hat icon + Issuer -->
                <!-- Description -->
                <!-- ====================== -->
                <article class="info-card info-card--cert">

                  <div class="cert-top">
                    <h4 class="info-card__title">
                      {%- if item.title and item.title != "" -%}
                        {{ item.title }}
                      {%- else -%}
                        Untitled Certificate
                      {%- endif -%}
                    </h4>

                    {%- if item.year and item.year != "" -%}
                      <span class="meta-pill cert-year">{{ item.year }}</span>
                    {%- endif -%}
                  </div>

                  {%- if item.issuer and item.issuer != "" -%}
                    <div class="cert-issuer">
                      <span class="cert-icon" aria-hidden="true">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M22 10L12 5 2 10l10 5 10-5z"/>
                          <path d="M6 12v5c0 .6 2.7 2 6 2s6-1.4 6-2v-5"/>
                        </svg>
                      </span>
                      <span class="cert-issuer-text">
                        {%- if item.url and item.url != "" -%}
                          <a href="{{ item.url }}" target="_blank" rel="noreferrer">{{ item.issuer }}</a>
                        {%- else -%}
                          {{ item.issuer }}
                        {%- endif -%}
                      </span>
                    </div>
                  {%- endif -%}

                  {%- if item.description and item.description != "" -%}
                    <p class="info-card__desc">{{ item.description }}</p>
                  {%- endif -%}

                </article>

              {%- else -%}
                <!-- ================= -->
                <!-- Generic card format -->
                <!-- ================= -->
                <article class="info-card info-card--generic">

                  <div class="generic-top">
                    {%- if item.year and item.year != "" -%}
                      <span class="generic-year">{{ item.year }}</span>
                    {%- endif -%}

                    {%- if item.url and item.url != "" -%}
                      <a class="meta-link" href="{{ item.url }}" target="_blank" rel="noreferrer">Link</a>
                    {%- endif -%}
                    {%- if item.github and item.github != "" -%}
                      <a class="meta-link" href="{{ item.github }}" target="_blank" rel="noreferrer">GitHub</a>
                    {%- endif -%}
                    {%- if item.demo and item.demo != "" -%}
                      <a class="meta-link" href="{{ item.demo }}" target="_blank" rel="noreferrer">Demo</a>
                    {%- endif -%}
                  </div>

                  <h4 class="info-card__title">
                    {%- if item.title and item.title != "" -%}
                      {{ item.title }}
                    {%- elsif item.name and item.name != "" -%}
                      {{ item.name }}
                    {%- else -%}
                      Untitled
                    {%- endif -%}
                  </h4>

                  {%- if item.issuer and item.issuer != "" -%}
                    <p class="info-card__desc"><b>{{ item.issuer }}</b></p>
                  {%- endif -%}

                  {%- if item.description and item.description != "" -%}
                    <p class="info-card__desc">{{ item.description }}</p>
                  {%- endif -%}

                </article>
              {%- endif -%}

            {%- endfor -%}
          </div>

        {%- else -%}
          <p class="muted">No items in this subsection.</p>
        {%- endif -%}

      {%- endfor -%}
    </section>
  {%- endfor -%}

{%- endif -%}
